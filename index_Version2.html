<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>範例應用入口 — 番茄鐘 / F1 行事曆</title>
  <style>
    :root{
      --bg: #0f1724;
      --card:#0b1220;
      --accent:#FF7043;
      --muted:#9aa4af;
      --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family: "Noto Sans TC", "Segoe UI", Roboto, Arial, sans-serif; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    body{
      background: linear-gradient(180deg,#07101a 0%, #07121a 100%);
      color:#e6eef8;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .wrap{
      width:980px;
      max-width:95vw;
      margin:0 auto;
    }

    .hero{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:18px;
    }
    .title{
      font-size:1.3rem;
      font-weight:700;
      letter-spacing:0.6px;
    }
    .subtitle{ color:var(--muted); font-size:0.95rem }

    .grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:16px;
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border:1px solid rgba(255,255,255,0.03);
      border-radius:12px;
      padding:18px;
      min-height:200px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      transition: transform .12s ease, box-shadow .12s ease;
      cursor:pointer;
    }
    .card:hover{ transform: translateY(-6px); box-shadow: 0 18px 40px rgba(0,0,0,0.6); }
    .card .name{ font-weight:800; font-size:1.05rem; color:#fff; }
    .card .desc{ color:var(--muted); margin-top:8px; font-size:0.95rem; }
    .card .actions{ display:flex; gap:10px; align-items:center; margin-top:12px; }
    .btn{
      padding:8px 12px;
      border-radius:8px;
      border: none;
      cursor:pointer;
      background:var(--glass);
      color:#fff;
      font-weight:700;
    }
    .btn.primary{
      background: linear-gradient(180deg,#ffb37a,#ff8a3d);
      color:#2b1b10;
    }

    /* iframe viewer overlay */
    .viewer{
      position:fixed;
      inset:0;
      display:none;
      align-items:stretch;
      justify-content:center;
      background: rgba(0,0,0,0.6);
      z-index:1000;
      padding:24px;
    }
    .viewer.open{ display:flex; }
    .viewer-inner{
      background:#fff;
      border-radius:10px;
      overflow:hidden;
      width:100%;
      height:100%;
      max-width:1200px;
      max-height:90vh;
      box-shadow: 0 24px 80px rgba(0,0,0,0.6);
      display:flex;
      flex-direction:column;
    }
    .viewer-bar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      padding:10px 12px;
      background: linear-gradient(180deg, rgba(0,0,0,0.03), transparent);
      border-bottom:1px solid rgba(0,0,0,0.06);
    }
    .viewer-title{ font-weight:800; color:#111; }
    .viewer-actions{ display:flex; gap:8px; align-items:center; }
    .back-btn{
      padding:8px 12px;
      border-radius:8px;
      border:none;
      background:#111;
      color:#fff;
      cursor:pointer;
      font-weight:700;
    }
    .open-new{
      padding:8px 12px;
      border-radius:8px;
      border:none;
      background:#e6eef8;
      color:#111;
      cursor:pointer;
      font-weight:700;
    }
    .viewer-frame{
      flex:1;
      border:0;
      width:100%;
      height:100%;
    }

    .student-info{
      text-align:right;
      color:var(--muted);
      font-size:0.95rem;
      line-height:1.4;
    }
    .student-info .label{ color:#fff; font-weight:700; display:block; }

    @media (max-width:880px){
      .grid{ grid-template-columns:1fr; }
      .hero{ flex-direction:column; align-items:flex-start; gap:8px; }
      .student-info{ text-align:left; }
    }
  </style>
</head>
<body>
  <div class="wrap" role="main" aria-labelledby="mainTitle">
    <div class="hero">
      <div>
        <div id="mainTitle" class="title">示範應用入口</div>
        <div class="subtitle">點選下面任一卡片以在頁面中打開應用（或選擇新分頁打開）</div>
      </div>

      <!-- 學生資訊已加入 -->
      <div class="student-info" aria-label="學生資訊">
        <span class="label">姓名：劉品言</span>
        <div>學號：41418126</div>
      </div>
    </div>

    <div class="grid" role="list">
      <div class="card" role="listitem" tabindex="0" id="cardTomato" aria-label="番茄鐘計時器">
        <div>
          <div class="name">番茄鐘計時器</div>
          <div class="desc">經典番茄鐘 UI — 設定分鐘/秒、開始/清除、到期背景閃爍（來源：indexr.html）</div>
        </div>
        <div class="actions">
          <button class="btn primary" data-src="indexr.html" data-title="番茄鐘計時器">開啟</button>
          <button class="btn" data-src="indexr.html" data-new="1">新分頁開啟</button>
        </div>
      </div>

      <div class="card" role="listitem" tabindex="0" id="cardCalendar" aria-label="F1 行事曆">
        <div>
          <div class="name">F1 風行事曆（賽車背景）</div>
          <div class="desc">月份行事曆，標示重要日期，帶賽車背景圖（來源：calendar-f1-with-car.html）</div>
        </div>
        <div class="actions">
          <button class="btn primary" data-src="calendar-f1-with-car.html" data-title="F1 行事曆">開啟</button>
          <button class="btn" data-src="calendar-f1-with-car.html" data-new="1">新分頁開啟</button>
        </div>
      </div>
    </div>
  </div>

  <!-- viewer overlay -->
  <div class="viewer" id="viewer" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="viewer-inner" role="document">
      <div class="viewer-bar">
        <div class="viewer-title" id="viewerTitle">應用</div>
        <div class="viewer-actions">
          <button class="open-new" id="openNewBtn">在新分頁開啟</button>
          <button class="back-btn" id="closeViewer">返回</button>
        </div>
      </div>
      <iframe id="appFrame" class="viewer-frame" title="應用視窗"></iframe>
    </div>
  </div>

  <script>
    const viewer = document.getElementById('viewer');
    const appFrame = document.getElementById('appFrame');
    const viewerTitle = document.getElementById('viewerTitle');
    const openNewBtn = document.getElementById('openNewBtn');
    const closeViewer = document.getElementById('closeViewer');

    document.querySelectorAll('.card .btn').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        const src = btn.getAttribute('data-src');
        const newTab = btn.getAttribute('data-new');
        const title = btn.getAttribute('data-title') || btn.closest('.card').querySelector('.name').textContent;
        if (newTab && newTab === '1') {
          // open in new tab
          window.open(src, '_blank', 'noopener');
          return;
        }
        openViewer(src, title);
      });
    });

    // also allow keyboard Enter on card to open main action
    document.querySelectorAll('.card').forEach(card=>{
      card.addEventListener('keydown', (e)=>{
        if (e.key === 'Enter' || e.key === ' ') {
          const primary = card.querySelector('.btn.primary');
          primary && primary.click();
        }
      });
    });

    function openViewer(src, title){
      viewerTitle.textContent = title || '應用';
      appFrame.src = src;
      openNewBtn.onclick = () => window.open(src, '_blank', 'noopener');
      viewer.classList.add('open');
      viewer.setAttribute('aria-hidden','false');
      // focus to iframe for accessibility
      setTimeout(()=> appFrame.focus(), 300);
    }

    function closeViewerFn(){
      viewer.classList.remove('open');
      viewer.setAttribute('aria-hidden','true');
      appFrame.src = 'about:blank';
    }

    closeViewer.addEventListener('click', closeViewerFn);
    // close when clicking backdrop (but not when clicking inside content)
    viewer.addEventListener('click', (e)=>{
      if (e.target === viewer) closeViewerFn();
    });

    // Escape to close
    window.addEventListener('keydown', (e)=>{
      if (e.key === 'Escape' && viewer.classList.contains('open')) closeViewerFn();
    });
  </script>
</body>
</html>